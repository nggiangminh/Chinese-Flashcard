<app-header></app-header>

<div class="grid-page py-5">
  <div class="container">
    <!-- Header -->
    <div class="row mb-4">
      <div class="col">
        <h1 class="display-5 text-black text-uppercase-brutal">üìù My Notes</h1>
      </div>
      <div class="col-auto">
        <button class="btn btn-secondary btn-lg" (click)="openCreateModal()">
          ‚ûï Create Note
        </button>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="text-center py-5">
      <div class="spinner-border text-secondary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-3 text-bold">Loading notes...</p>
    </div>

    <!-- Empty State -->
    <div *ngIf="!isLoading && notes.length === 0" class="text-center py-5">
      <div class="card border-brutal shadow-brutal bg-brutal-secondary p-5">
        <h3 class="text-black mb-3">No notes yet</h3>
        <p class="text-bold mb-4">Create your first note to get started!</p>
        <button class="btn btn-secondary btn-lg" (click)="openCreateModal()">
          Create Your First Note
        </button>
      </div>
    </div>

    <!-- Notes Grid -->
    <div class="row g-4" *ngIf="!isLoading && notes.length > 0">
      <div class="col-md-4" *ngFor="let note of notes">
        <div class="card h-100 border-brutal shadow-brutal card-hover">
          <div class="card-body p-4">
            <h3 class="h4 text-black text-uppercase-brutal mb-3">{{ note.title }}</h3>
            <p class="mb-3" style="display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;">
              {{ note.content }}
            </p>
            <p class="text-muted small mb-0">
              <strong>Created:</strong> {{ note.createdAt | date:'short' }}
            </p>
          </div>
          <div class="card-footer border-brutal-top bg-white">
            <button class="btn btn-sm btn-outline-primary me-2" (click)="openEditModal(note)">
              Edit
            </button>
            <button class="btn btn-sm btn-outline-danger" (click)="onNoteDelete(note.id)">
              Delete
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal" [class.show]="showFormModal" [style.display]="showFormModal ? 'block' : 'none'" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header border-brutal-bottom">
        <h5 class="modal-title text-black">{{ editingNote ? 'Edit' : 'Create' }} Note</h5>
        <button type="button" class="btn-close" (click)="closeModal()"></button>
      </div>
      <div class="modal-body p-4">
        <app-note-form 
          [note]="editingNote"
          (saved)="onNoteSaved()"
          (cancelled)="closeModal()">
        </app-note-form>
      </div>
    </div>
  </div>
</div>

<!-- Modal Backdrop -->
<div class="modal-backdrop fade" [class.show]="showFormModal" *ngIf="showFormModal"></div>

<app-footer></app-footer>
